# 브라우저의 렌더링 과정

## 브라우저란?

-   인터넷에 접속하여 웹 페이지를 열람할 수 있도록 도와주는 소프트웨어
-   사용자는 브라우저를 통해 웹 사이트의 텍스트, 이미지, 비디오 등 다양한 콘텐츠를 볼 수 있으며, 웹 애플리케이션과 상호작용할 수 있음
-   인터넷과 사용자간의 다리 역할

## 렌더링 과정

-   사용자가 브라우저를 통해 웹 사이트에 접속하면, 서버로 부터 HTML, CSS등 필요한 리소스를 다운로드 받음
-   브라우저가 페이지를 렌더링 하려면 HTML 코드는 DOM, CSS는 CSSOM 트리를 생성해야함

    1.1.`DOM 트리 생성`

    -   1.변환: 브라우저가 HTML의 원시 바이트를 읽어와서, HTML에 정의된 인코딩(ex: UTF-8)에 따라 개별 문자로 변환
    -   2.토큰화: 브라우저가 문자열을 W3C표준에 지정된 고유 토큰으로 변환
    -   3.렉싱: 방출된 토큰은 해당 속성 및 규칙을 정의하는 "객체"로 변환
    -   4.DOM 생성: HTML 마크업에 정의된 여러 태그간의 관계를 해석하여 트리구조로 연결

    1.2.`CSSOM 트리 생성`

    -   HTML 마크업내에 직접(inline)스타일을 선언할수도 있지만, head태그에 외부(external) css 파일을 참조하거나, head 태그에 style 태그(internal)를 정의 할수 있음
    -   HTML과 동일하게 브라우저가 이해하고 처리할 수 있는 형식으로 변환해야함
    -   DOM트리를 생성하는 과정과 동일하게 CSSOM 트리를 생성함

    2.`렌더링 트리(Rendering Tree) 생성`

    -   DOM 트리와 CSSOM 트리가 만들어지면 이 둘 을 결합하여 렌더링 트리를 생성
    -   렌더링 트리에는 페이지를 렌더링 하는데 필요한 노드만 포함됨

    3.`레이아웃(Layout)단계`

    -   뷰포트 내에서 각 요소의 정확한 위치와 크기를 정확하게 캡쳐하는 Box 모델일 출력됨
    -   모든 상대적인 측정값은 화면에서 절대적인 픽셀로 변환

    4.`페인팅 단계`

    -   마지막으로 렌더링 트리의 각 노드를 화면의 실제 픽셀로 변환하게됨
    -   레이아웃 단계에서 모든 계산이 완료가 되면, 화면에 요소들을 그림
    -   이단계를 "페인팅" 또는 "래스터화"라고 함
    -   레이아웃 단계에서 각 노드들이 위치, 크기, 색상 등 스타일이 모두 계산되었기 때문에 화면에 실제 픽셀로 변환하게 됨

    ### 리플로우(Reflow), 리페인트(Repaint)

    -   사용자가 처음 접속시, 렌더링 과정을 거쳐서 화면에 모든 요소를 그려지게됨
    -   이후에 사용자는 다양한 액션을 수행하게 되고, 여기서 발생되는 이벤트로 인해서 새로운 HTML 요소가 추가되거나, 기존 요소의 스타일이 바뀌거나 하는 변경이 일어나게 됨
    -   이런 변경을 통해 영향을 받는 모든 노드에 대해 렌더링 트리 생성과 레이아웃 과정을 다시 수행하게됨
    -   이과정을 리플로우(Reflow) 라고함

    -   리플로우는 변경사항을 반영하기 위해 렌더링 트리를 생성하고 레이아웃 과정을 다시 수행하는것
    -   화면에 결과를 그리기 위해선 다시 페인팅 단계를 수행해야함
    -   이 과정을 리페인트(Repain) 라고함

    -   기존요소에 변경사항이 생길때마다 항상 리플로우-리페인트가 일어나는것은 아님
    -   레이아웃에 영향이 미치지않는 단순한 색상 변경등은 리플로우 없이 리페인트만 수행하게 됨
    -   (리플로우가 일어나면 반드시 리페인트가 일어남)

    ### 리플로우가 일어나는 속성들

    position, width, height, margin, padding, border, border-width, font-size, font-weight, line-height, text-align, overflow

    ## 리페인트만 일어나는 속성들

    background, color, text-decoration, border-style, border-radius
